using System;using System.Collections.Generic;using System.Globalization;using System.Linq;using System.Text;using System.Threading.Tasks;namespace Module_1{    public class HotelManagementSystem : IHotelManagementSystem    {        List<Room> DanhSachPhong = new List<Room>(); //Luu tru thong tin phong khach san        int BookingID = 1;        List<Booking> DanhSachBooking = new List<Booking>(); //Luu tru lich su booking        public void AddRoom(int n)         {            for (int i = 0; i < n; i++) {                Console.WriteLine($"Nhap thong tin phong thu {i + 1} cua khach san:");                Console.Write("So phong: ");                string SoPhong = Console.ReadLine();                Console.Write("Loai phong (1 - Standard, 2 - Superior; 3 - Deluxe; 4 - Suite): ");                string LoaiPhong = Console.ReadLine();                Console.Write("Mo ta: ");                string moTa = Console.ReadLine();                Console.Write("Gia (/Ngay): ");                string Gia = Console.ReadLine();                // Neu khong co loi thi luu du lieu                if (ValidationData.KiemTraInputSoPhong(SoPhong) && ValidationData.KiemTraInputLoaiPhong(LoaiPhong) && ValidationData.KiemTraInputChu(moTa) && ValidationData.KiemTraInputGia(Gia))                {                    int soPhong = Convert.ToInt32(SoPhong);                    //Check xem bi trung RoomNumber ko                    Room phongCheck = DanhSachPhong.Find(p => p.RoomNumber == soPhong);                    if (phongCheck == null)                    {                        int loaiPhong = Convert.ToInt32(LoaiPhong);                        long gia = Convert.ToInt64(Gia);                        Room phong = new Room();                        if (loaiPhong == 1)                        {                            phong.RoomNumber = soPhong;                            phong.RoomType = RoomType.Standard;                            phong.Description = moTa;                            phong.Cost = gia;                            phong.State = State.Unoccupied;                            DanhSachPhong.Add(phong);                            Console.WriteLine($"Them phong {soPhong} cho he thong quan ly khach san thanh cong!");                        }                        else if (loaiPhong == 2)                        {                            phong.RoomNumber = soPhong;                            phong.RoomType = RoomType.Superior;                            phong.Description = moTa;                            phong.Cost = gia;                            phong.State = State.Unoccupied;                            DanhSachPhong.Add(phong);                            Console.WriteLine($"Them phong {soPhong} cho he thong quan ly khach san thanh cong!");                        }                        else if (loaiPhong == 3)                        {                            phong.RoomNumber = soPhong;                            phong.RoomType = RoomType.Deluxe;                            phong.Description = moTa;                            phong.Cost = gia;                            phong.State = State.Unoccupied;                            DanhSachPhong.Add(phong);                            Console.WriteLine($"Them phong {soPhong} cho he thong quan ly khach san thanh cong!");                        }                        else if (loaiPhong == 4)                        {                            phong.RoomNumber = soPhong;                            phong.RoomType = RoomType.Suite;                            phong.Description = moTa;                            phong.Cost = gia;                            phong.State = State.Unoccupied;                            DanhSachPhong.Add(phong);                            Console.WriteLine($"Them phong {soPhong} cho he thong quan ly khach san thanh cong!");                        }                    } else {                        Console.WriteLine("So cua phong khach san da duoc su dung, vui long nhap so phong khac.");                    }                } else {                    Console.WriteLine($"Xay ra loi khi nhap thong tin phong. Chuong trinh xin bo qua thong tin phong thu {i + 1} cua khach san.");                }            }        }        public void RemoveRoom(Room room) {            DanhSachPhong.Remove(DanhSachPhong.Find(p => p.RoomNumber == room.RoomNumber));        }        public void UpdateRoom(string input)        {            Room phongCheck = DanhSachPhong.Find(p => p.RoomNumber == Convert.ToInt32(input));            int PhongCuIndex = DanhSachPhong.IndexOf(phongCheck);            if (PhongCuIndex != -1)            {                Console.WriteLine($"Nhap thong tin moi cho phong so {Convert.ToInt32(input)}:");                Console.Write("So phong: ");                string SoPhong = Console.ReadLine();                Console.Write("Loai phong (1 - Standard, 2 - Superior; 3 - Deluxe; 4 - Suite): ");                string LoaiPhong = Console.ReadLine();                Console.Write("Mo ta: ");                string moTa = Console.ReadLine();                Console.Write("Gia: ");                string Gia = Console.ReadLine();                // Neu khong co loi thi luu du lieu                if (ValidationData.KiemTraInputSoPhong(SoPhong) && ValidationData.KiemTraInputLoaiPhong(LoaiPhong) && ValidationData.KiemTraInputChu(moTa) && ValidationData.KiemTraInputGia(Gia))                {                    int soPhong = Convert.ToInt32(SoPhong);                    int loaiPhong = Convert.ToInt32(LoaiPhong);                    long gia = Convert.ToInt64(Gia);                    Room phong = new Room();                    if (loaiPhong == 1)                    {                        phong.RoomNumber = soPhong;                        phong.RoomType = RoomType.Standard;                        phong.Description = moTa;                        phong.Cost = gia;                        phong.State = State.Unoccupied;                        DanhSachPhong[PhongCuIndex] = phong;                        Console.WriteLine($"Cap nhat thong tin thanh cong!");                    }                    else if (loaiPhong == 2)                    {                        phong.RoomNumber = soPhong;                        phong.RoomType = RoomType.Superior;                        phong.Description = moTa;                        phong.Cost = gia;                        phong.State = State.Unoccupied;                        DanhSachPhong[PhongCuIndex] = phong;                        Console.WriteLine($"Cap nhat thong tin thanh cong!");                    }                    else if (loaiPhong == 3)                    {                        phong.RoomNumber = soPhong;                        phong.RoomType = RoomType.Deluxe;                        phong.Description = moTa;                        phong.Cost = gia;                        phong.State = State.Unoccupied;                        DanhSachPhong[PhongCuIndex] = phong;                        Console.WriteLine($"Cap nhat thong tin thanh cong!");                    }                    else if (loaiPhong == 4)                    {                        phong.RoomNumber = soPhong;                        phong.RoomType = RoomType.Suite;                        phong.Description = moTa;                        phong.Cost = gia;                        phong.State = State.Unoccupied;                        DanhSachPhong[PhongCuIndex] = phong;                        Console.WriteLine($"Cap nhat thong tin thanh cong!");                    }                } else {                    Console.WriteLine($"Xay ra loi khi nhap thong tin cap nhat cua phong.");                }            } else {                Console.WriteLine("Khong tim thay phong tuong ung.");            }        }        public Room SearchRoom(string input) {            foreach (Room phong in DanhSachPhong)
            {
                if (phong.RoomNumber == Convert.ToInt32 (input))
                {
                    return phong;
                }
            }            return null;        }        public void AddBooking()        {            Console.Write("Nhap loai phong ban muon book (1 - Standard, 2 - Superior; 3 - Deluxe; 4 - Suite): ");            string LoaiPhong = Console.ReadLine();            if (ValidationData.KiemTraInputLoaiPhong(LoaiPhong))            {                int loaiPhong = Convert.ToInt32(LoaiPhong);                //Chon phong voi Loai phong tuong ung, va trang thai la Unoccupied                Room phongBook = new Room();                switch (loaiPhong)                {                    case 1:                        phongBook = DanhSachPhong.Find(p => p.RoomType == RoomType.Standard && p.State == State.Unoccupied);                        break;                    case 2:                        phongBook = DanhSachPhong.Find(p => p.RoomType == RoomType.Superior && p.State == State.Unoccupied);                        break;                    case 3:                        phongBook = DanhSachPhong.Find(p => p.RoomType == RoomType.Deluxe && p.State == State.Unoccupied);                        break;                    case 4:                        phongBook = DanhSachPhong.Find(p => p.RoomType == RoomType.Suite && p.State == State.Unoccupied);                        break;                    default:                        Console.WriteLine("Lua chon khong hop le.");                        break;                }                if (phongBook != null)                {                    int phongBookIndex = DanhSachPhong.FindIndex(p => p.RoomNumber == phongBook.RoomNumber);                    Console.WriteLine("Da tim thay phong tuong ung!");                    //Nhap cac ngay su dung phong                    Console.Write("Nhap ngay bat dau su dung phong (MM/dd/yyyy): ");                    string NgayBatDau = Console.ReadLine();                    Console.Write("Nhap ngay ket thuc su dung phong (MM/dd/yyyy): ");                    string NgayKetThuc = Console.ReadLine();                    //Check ngay dat khach san                    if (ValidationData.KiemTraInputNgayDatKhachSan(NgayBatDau) && ValidationData.KiemTraInputNgayDatKhachSan(NgayKetThuc) && ( DateTime.Parse(NgayKetThuc) - DateTime.Parse(NgayBatDau)).TotalDays > 0 ) {                        //Xac nhan dat phong                        Console.WriteLine("Xac nhan dat phong (1 - Co, 2 - Khong)");                        string XacNhanDatPhong = Console.ReadLine();                        switch (XacNhanDatPhong)                        {                            case "1":                                DateTime ngayBatDau = DateTime.ParseExact(NgayBatDau, "mm/dd/yyyy", CultureInfo.InvariantCulture); //Convert ngay bat dau dat phong                                DateTime ngayKetThuc = DateTime.ParseExact(NgayKetThuc, "mm/dd/yyyy", CultureInfo.InvariantCulture); //Convert ngay ket thuc dat phong                                                            DanhSachBooking.Add(new Booking(BookingID, phongBook.RoomNumber, phongBook.Cost, ngayBatDau, ngayKetThuc, DateTime.Now)); //Add thong tin Booking                                BookingID++; //Tu dong tang BookingID cho nhung lan dat sau                                DanhSachPhong[phongBookIndex].State = State.Occupied; //Chuyen doi trang thai cua phong                                break;                            case "2":                                Console.WriteLine("Da huy dat phong.");                                break;                            default:                                Console.WriteLine("Lua chon xac nhan khong hop le.");                                break;                        }                    } else {                        Console.WriteLine("Xay ra loi khi nhap ngay su dung khach san.");                    }                } else {                    Console.WriteLine("Khong tim thay phong kha dung.");                }            } else {                Console.WriteLine("Xay ra loi khi nhap loai phong (nhap so tu 1-4).");            }        }        public void RemoveBooking(Booking booking)         {            DanhSachBooking.Remove(booking); //Xoa booking khoi danh sach            DanhSachPhong.Find(p => p.RoomNumber == booking.RoomNumber).State = State.Unoccupied; //Chuyen doi trang thai cua phong khach san        }        public void UpdateBooking()         {            Console.WriteLine("Nhap ID cua Booking ma ban muon cap nhat: ");            string id = Console.ReadLine();            while (!ValidationData.KiemTraInputSoPhong(id))            {                Console.WriteLine("Vui long nhap lai Booking ID hop le.");                id = Console.ReadLine();            }            Booking bookingCu = SearchBooking(id);            if (bookingCu != null) //Check xem co booking tuong ung ko            {                int BookingCuIndex = DanhSachBooking.FindIndex(b => b.RoomNumber == bookingCu.RoomNumber);                if (BookingCuIndex > 0)                {                    RemoveBooking(bookingCu);                    Console.Write("Nhap loai phong ban muon update trong booking (1 - Standard, 2 - Superior; 3 - Deluxe; 4 - Suite): ");                    string LoaiPhong = Console.ReadLine();                    if (ValidationData.KiemTraInputLoaiPhong(LoaiPhong))                    {                        int loaiPhong = Convert.ToInt32(LoaiPhong);                        Room phongBook = new Room();                        switch (loaiPhong)                        {                            case 1:                                foreach (Room phong in DanhSachPhong)                                {                                    if (phong.RoomType == RoomType.Standard && phong.State == State.Unoccupied)                                    {                                        phongBook = phong;                                    }                                }                                break;                            case 2:                                foreach (Room phong in DanhSachPhong)                                {                                    if (phong.RoomType == RoomType.Superior && phong.State == State.Unoccupied)                                    {                                        phongBook = phong;                                    }                                }                                break;                            case 3:                                foreach (Room phong in DanhSachPhong)                                {                                    if (phong.RoomType == RoomType.Deluxe && phong.State == State.Unoccupied)                                    {                                        phongBook = phong;                                    }                                }                                break;                            case 4:                                foreach (Room phong in DanhSachPhong)                                {                                    if (phong.RoomType == RoomType.Suite && phong.State == State.Unoccupied)                                    {                                        phongBook = phong;                                    }                                }                                break;                            default:                                Console.WriteLine("Lua chon khong hop le.");                                break;                        }                        if (phongBook != null)                        {                            int phongBookIndex = DanhSachPhong.FindIndex(p => p.RoomNumber == phongBook.RoomNumber);                            Console.WriteLine("Da tim thay phong tuong ung!");                            //Nhap cac ngay su dung phong                            Console.WriteLine("Nhap ngay bat dau su dung phong (MM/dd/yyyy): ");                            string NgayBatDau = Console.ReadLine();                            Console.WriteLine("Nhap ngay ket thuc su dung phong (MM/dd/yyyy): ");                            string NgayKetThuc = Console.ReadLine();                            //Check ngay dat khach san                            if (ValidationData.KiemTraInputNgayDatKhachSan(NgayBatDau) && ValidationData.KiemTraInputNgayDatKhachSan(NgayKetThuc) && (DateTime.Parse(NgayKetThuc) - DateTime.Parse(NgayBatDau)).TotalDays > 0)                            {                                //Xac nhan dat phong                                Console.WriteLine("Xac nhan dat phong (Nhap Co hoac Khong)");                                string XacNhanDatPhong = Console.ReadLine();                                while (XacNhanDatPhong != "Co" || XacNhanDatPhong != "Khong")                                {                                    Console.WriteLine("Vui long xac nhan lai viec dat phong (Nhap Co hoac Khong)");                                    XacNhanDatPhong = Console.ReadLine();                                }                                //Dat phong                                if (XacNhanDatPhong == "Co")                                {                                    DateTime ngayBatDau = DateTime.ParseExact(NgayBatDau, "mm/dd/yyyy", CultureInfo.InvariantCulture); //Convert ngay bat dau dat phong                                    DateTime ngayKetThuc = DateTime.ParseExact(NgayKetThuc, "mm/dd/yyyy", CultureInfo.InvariantCulture); //Convert ngay ket thuc dat phong                                    DanhSachBooking.Add(new Booking(Convert.ToInt32(id), phongBook.RoomNumber, phongBook.Cost, ngayBatDau, ngayKetThuc, DateTime.Now)); //Add thong tin Booking                                    DanhSachPhong[phongBookIndex].State = State.Occupied; //Chuyen doi trang thai cua phong                                }                                else if (XacNhanDatPhong == "Khong")                                {                                    Console.WriteLine("Da huy dat phong.");                                }                            }                            else                            {                                Console.WriteLine("Xay ra loi khi nhap ngay su dung khach san.");                            }                        }                        else                        {                            Console.WriteLine("Khong tim thay phong kha dung.");                        }                    }                    else                    {                        Console.WriteLine("Xay ra loi khi nhap loai phong (nhap so tu 1-4).");                    }                }                else                {                    Console.WriteLine("Khong tim thay Booking yeu cau.");                }            } else {                Console.WriteLine("Khong tim thay Booking yeu cau.");            }        }        public void DisplayBooking() {            foreach (Booking booking in DanhSachBooking)            {                Console.WriteLine(booking);            }        }                public Booking SearchBooking(string input)        {            if (!ValidationData.KiemTraInputSoPhong(input))            {                return null;            }            foreach (Booking booking in DanhSachBooking)            {                if (booking.BookingId == Convert.ToInt32(input))                {                    return booking;                }            }            return null;        }    }}